{
    "chain_policies":
    {
        "input": "ACCEPT",
        "output": "ACCEPT",
        "forward": "DROP"
    },

    "filter_rules":
    {
        "1":
        {
	    "comment": "allow internal connections on loopback interface"
	    "chain": "INPUT",
            "interface": "lo",
            "target": "ACCEPT",
        },
        "2":
        {
	    "comment": "allow incoming SSH from WSU public and private networks"
            "chain": "INPUT"
            "source_ip": "156.26.0.0/16,172.0.0.0/8",
            "destination_port": "22",
            "target": "ACCEPT",
        },
        "3":
        {
	    "comment": "allow incoming SSH from WSU VPN private network"
            "chain": "INPUT"
            "source_ip": "10.250.0.0/24",
            "destination_port": "22",
            "target": "ACCEPT",
        },
        "100":
        {
	    "comment": "allow incoming CFEngine connections for policy_server only"
            "chain": "INPUT"
            "source_ip": "156.26.0.0/16,172.0.0.0/8,10.250.0.0/24",
            "destination_port": "5308",
            "target": "ACCEPT",
	    "context": "policy_server",
        },

        "201":
        {
	    "comment": "allow incoming HTTP from WSU networks for wsu_web_access"
            "chain": "INPUT"
            "source_ip": "156.26.0.0/16,172.0.0.0/8,10.250.0.0/24",
            "destination_port": "80",
            "target": "ACCEPT",
	    "context": "wsu_web_access"
        },
        "202":
        {
	    "comment": "allow incoming HTTPS from WSU networks for wsu_web_access"
            "chain": "INPUT"
            "source_ip": "156.26.0.0/16,172.0.0.0/8,10.250.0.0/24",
            "destination_port": "443",
            "target": "ACCEPT",
	    "context": "wsu_web_access"
        },


	"1000":
        {
	    "comment": "final INPUT rule REJECTS all other connections"
            "chain": "INPUT",
            "target": "REJECT",
        },
    }
}

